

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>v1.4 - Newznab Actual Api Limits &mdash; Torznab Specification 1.3-alpha documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/css/example.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/tags.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/highlight-xml.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme-override.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Torznab Specification 1.3-alpha documentation" href="../index.html"/>
        <link rel="up" title="Revisions" href="index.html"/>
        <link rel="next" title="External References" href="../external/index.html"/>
        <link rel="prev" title="v1.3 - Torznab Release Tags" href="1.3-Torznab-Release-Tags.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Torznab Specification
          

          
          </a>

          
            
            
              <div class="version">
                1.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../torznab/index.html">Torznab Specification</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Revisions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1.0-Torznab-Torrent-Support.html">v1.0 - Torznab Torrent Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.1-Newznab-supportedParams.html">v1.1 - Newznab supportedParams</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.2-Torznab-Download-Upload-Factors.html">v1.2 - Torznab Download/Upload Factors</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.3-Torznab-Release-Tags.html">v1.3 - Torznab Release Tags</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">v1.4 - Newznab Actual Api Limits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#actual-api-limits">Actual Api Limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adoption">Adoption</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../external/index.html">External References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Torznab Specification</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Revisions</a> &raquo;</li>
        
      <li>v1.4 - Newznab Actual Api Limits</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/revisions/1.4-Newznab-Actual-Api-Limits.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="v1-4-newznab-actual-api-limits">
<h1>v1.4 - Newznab Actual Api Limits<a class="headerlink" href="#v1-4-newznab-actual-api-limits" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Status:</th><td class="field-body"><p class="first"><strong>Draft</strong> <span class="flag">newznab</span> <span class="flag">torznab</span></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Date:</th><td class="field-body"><p class="first">November 2019</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Attributions:</th><td class="field-body"><ul class="first last simple">
<li>bb <em>(newznab)</em></li>
<li>DariusIII <em>(nntmux/nzedb)</em></li>
<li>Taloth Saldono <em>(Sonarr)</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Currently users can only determine their current api and grab limits and usage in their profile page.
This revision introduces an additional element in the api response to provide this information to clients directly,
allowing them to rate limit their api calls.</p>
</div>
<div class="section" id="actual-api-limits">
<h2>Actual Api Limits<a class="headerlink" href="#actual-api-limits" title="Permalink to this headline">¶</a></h2>
<p>Add a <cite>newznab:apilimits</cite> element to the api response.</p>
<div class="admonition example">
<p class="first admonition-title">Example</p>
<div class="last highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;rss&gt;</span>
   <span class="nt">&lt;channel&gt;</span>
      ...
      <span class="nt">&lt;newznab:response</span> <span class="na">offset=</span><span class="s">&quot;0&quot;</span> <span class="na">total=</span><span class="s">&quot;10000&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;newznab:apilimits</span> <span class="na">apiCurrent=</span><span class="s">&quot;3&quot;</span> <span class="na">apiMax=</span><span class="s">&quot;100&quot;</span> <span class="nt">/&gt;</span>
      ...
   <span class="nt">&lt;/channel&gt;</span>
<span class="nt">&lt;/rss&gt;</span>
</pre></div>
</div>
</div>
<p>Clients <em>should</em> not assume the <cite>apilimits</cite> element or any of it’s attributes to be present in the api response.</p>
<p>Servers <em>may</em> include the <cite>apilimits</cite> element if the server has api/grab limits.</p>
<p>The <cite>apilimits</cite> element may contain the following attributes:</p>
<table border="1" class="small docutils">
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="6%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">type</th>
<th class="head">default</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>apiCurrent</td>
<td>number</td>
<td>0</td>
<td>The number of api calls that have been exhaused in the last 24 hours</td>
</tr>
<tr class="row-odd"><td>apiMax</td>
<td>number</td>
<td>∞</td>
<td>The number of api calls that may be used in a 24 hours</td>
</tr>
<tr class="row-even"><td>grabCurrent</td>
<td>number</td>
<td>0</td>
<td>The number of grabs that have been used in the last 24 hours</td>
</tr>
<tr class="row-odd"><td>grabMax</td>
<td>number</td>
<td>∞</td>
<td>The number of grabs that may be used in a 24 hours</td>
</tr>
<tr class="row-even"><td>apiNextAvailable</td>
<td>string</td>
<td>&#160;</td>
<td>UTC Timestamp specifying the time at which apiCurrent will be decremented</td>
</tr>
<tr class="row-odd"><td>grabNextAvailable</td>
<td>string</td>
<td>&#160;</td>
<td>UTC Timestamp specifying the time at which grabCurrent will be decremented</td>
</tr>
</tbody>
</table>
<p>Clients <em>should</em> not make further api calls if the <cite>apiCurrent</cite> is equal or greater than <cite>apiMax</cite> until a reasonable time has passed.
‘Reasonable time’ becomes the time specified by <cite>apiNextAvailable</cite> if it’s provided.</p>
<p>Servers <em>should</em> provide the <cite>apiCurrent</cite>, <cite>apiMax</cite>, <cite>grabCurrent</cite> and <cite>grabMax</cite> attributes when any such limit exists.</p>
<p>Servers <em>should</em> return values matching the state after the current api call has been completed.</p>
<p>Servers <em>may</em> provide the <cite>apiNextAvailable</cite> and <cite>grabNextAvailable</cite> attributes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Servers should avoid including attributes that require additional database lookups to avoid an increase in the server’s load.
However, the <cite>apiCurrent</cite> and <cite>apiMax</cite> attributes are quite beneficial to clients and should be included whenever possible.</p>
<p class="last">It’s likely possible to refactor the sql queries to provide the desired information in a single db query.</p>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Incomplete</p>
</div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>A client has almost reached the api limit, a query at 2019-07-16 11:56 UTC returns:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;newznab:apilimits</span> <span class="na">apiCurrent=</span><span class="s">&quot;90&quot;</span> <span class="na">apiMax=</span><span class="s">&quot;100&quot;</span> <span class="na">grabCurrent=</span><span class="s">&quot;5&quot;</span> <span class="na">grabMax=</span><span class="s">&quot;5&quot;</span> <span class="na">apiNextAvailable=</span><span class="s">&quot;Tue, 16 Jul 2019 20:56:54 +0000&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>The client only has 10 api calls left in the next 8 hours, so should limit itself to one api call (rss) per hour.
This means that the client has exhausted all available grabs, it is unknown at which a new grab becomes available, but a future api call will show when it does.</p>
</div>
<div class="section" id="adoption">
<h2>Adoption<a class="headerlink" href="#adoption" title="Permalink to this headline">¶</a></h2>
<p>These changes were discussed with the newznab staff in mid 2019, but may take some time to be in use by indexers.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../external/index.html" class="btn btn-neutral float-right" title="External References" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="1.3-Torznab-Release-Tags.html" class="btn btn-neutral" title="v1.3 - Torznab Release Tags" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2018 Taloth Saldono.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.3-alpha',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>